Sub ticker()

'Set all variables
Dim ticker_name As String
Dim yearly_open As Double
Dim yearly_end As Double
Dim counter As Double
Dim open_close As Double
Dim stock_volume As Double

'define variables

For Each ws In Worksheets
    counter = 2
    stock_volume = 0
    open_close = 2
    
    ws.Range("I1") = "Ticker"
    ws.Range("J1") = "Yearly Change"
    ws.Range("K1") = "Percent Change"
    ws.Range("L1") = "Total Stock Volume"
    
    For i = 2 To ws.Cells(Rows.Count, 1).End(xlUp).Row
        stock_volume = stock_volume + ws.Cells(i, 7).Value
        ticker_name = ws.Cells(i, 1).Value
        yearly_open = ws.Cells(i, 3)
        
         If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then
         yearly_end = ws.Cells(i, 6)
         ws.Cells(counter, 9).Value = ticker_name
         ws.Cells(counter, 10).Value = yearly_end - yearly_open
         
          ' Print the Ticker name to summary
      ws.Range("I" & counter).Value = ticker_name
         
         If yearly_open = 0 Then
            ws.Cells(counter, 11).Value = Null
        Else
            ws.Cells(counter, 11).Value = (yearly_end - yearly_open) / yearly_open
        End If
        ws.Cells(counter, 12).Value = stock_volume
        
        If ws.Cells(counter, 10).Value > 0 Then
            ws.Cells(counter, 10).Interior.ColorIndex = 4
        Else
            ws.Cells(counter, 10).Interior.ColorIndex = 3
        End If
        
        ' Change formatting for percent change column
        ws.Cells(counter, 11).NumberFormat = "0.00%"
        
        stock_volume = 0
        counter = counter + 1
        open_close = i + 1
        
        End If
        
    Next i
    
    'Autofit columns
    'combined_sheet.Columns("I:L").AutoFit
    
    Next ws

End Sub
